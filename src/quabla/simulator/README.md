# 支配方程式
詳細な支配方程式は航空宇宙技術研究所（旧NAL）の「スピンを伴うロケットの運動を計算するプログラム」を参考にされたい。

# 力学モデル
## 弾道飛行
以下の13変数を解く。
* 地面固定座標系における機体重心の位置ベクトル（3変数）
* 機体軸系における機体重心の速度ベクトル（3変数）
* 機体重心における角速度（3変数）
* クォータニオン（4変数）

### 位置
剛体位置の方程式では外力として以下を考慮する。
* 空気力
   * 抗力（軸力）
   * 法線力
   * 横力
* エンジンの推力
   * 運動量推力
   * 圧力推力
* 重力

ランチクリア前は以上のうち，機軸方向成分のみを考慮している。

### 回転
外力モーメントとして，以下を考慮する。
* 空力復元モーメント
* 空力減衰モーメント
* ジェットダンピングモーメント
    * 慣性モーメントの時間変化由来の減衰モーメントのみ考慮

ランチクリア前は回転しないと仮定している。

## 減速落下
以下の4変数を解く。
* 地面固定座標系における機体重心の位置ベクトル（3変数）
* 機体降下速度（1変数）

# 環境モデル
US Standard Atmosphere 1976の11 kmまでの大気モデルに対応。

# 質量，重心，慣性モーメントモデル
## 質量モデル
* 推進剤（グレイン+酸化剤）<br>
  時間変化率が推力に比例すると仮定して，
推進剤時間変化率の微分方程式を4次のRunge-Kutta法で解くことで推進剤質量の時間変化を得ている。
* グレイン<br>
  定常燃焼終了（燃焼開始から燃焼時間）まで時間一定で減少
* 酸化剤<br>
  推進剤質量とグレイン質量の差分で求めている。

## 重心モデル
* グレイン<br>
 重心は変化しないと仮定。
* 酸化剤<br>
  液柱の中心を重心と仮定。液柱の長さは酸化剤質量に比例すると仮定。

## 慣性モーメントモデル
* グレイン<br>
 中空円筒と仮定。
* 酸化剤<br>
  中実円柱を仮定。スロッシングの影響を考慮しない。


# 微分方程式の解法
* Runge-Kutta（4次）
* Adams-Bashforth-Moulton（Predictor-Corrector Method）<br>
   * Adams-Bashforth：4次
   * Adams-Moulton：3次
   * Adaptive Time Stepping（適応時間刻み）による時間刻み自動調整機能付き
   * 燃焼終了後から少しした後に，時間刻みを変更している。

# 関数補間
補間を行っている全変数は線形補間により補間される。
領域探索にはArrayUtilの二分探索メソッドを用いた。
